# üîí –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å –ø—Ä–∏ –¥–µ–ø–ª–æ–µ

## ‚ö†Ô∏è –ö–†–ò–¢–ò–ß–ï–°–ö–ò –í–ê–ñ–ù–û

### ‚ùå –ù–ò–ö–û–ì–î–ê –ù–ï –î–ï–õ–ê–ô–¢–ï:

1. **–ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ git:**
   - Personal Access Tokens
   - SSH –∫–ª—é—á–∏ (–ø—Ä–∏–≤–∞—Ç–Ω—ã–µ)
   - –ü–∞—Ä–æ–ª–∏
   - API –∫–ª—é—á–∏

2. **–ù–ï –æ—Ç–ø—Ä–∞–≤–ª—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ —á–∞—Ç—ã/email**
3. **–ù–ï –ø–æ–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –Ω–∞ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö**
4. **–ù–ï —Ö—Ä–∞–Ω–∏—Ç–µ —Ç–æ–∫–µ–Ω—ã –≤ –æ—Ç–∫—Ä—ã—Ç–æ–º –≤–∏–¥–µ**

---

## ‚úÖ –ü—Ä–∞–≤–∏–ª—å–Ω–∞—è —Ä–∞–±–æ—Ç–∞ —Å —Ç–æ–∫–µ–Ω–∞–º–∏

### 1. GitHub Personal Access Token

**–°–æ–∑–¥–∞–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞:**
1. GitHub ‚Üí Settings ‚Üí Developer settings ‚Üí Personal access tokens ‚Üí Tokens (classic)
2. Generate new token (classic)
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∏:
   - **Note:** "Server Deploy - Auto" (–æ–ø–∏—Å–∞—Ç–µ–ª—å–Ω–æ–µ –∏–º—è)
   - **Expiration:** 90 –¥–Ω–µ–π (—Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)
   - **Scopes:** –¢–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ:
     - ‚úÖ `repo` - –¥–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—é
     - ‚ùå –ù–ï –≤—ã–±–∏—Ä–∞–π—Ç–µ –≤—Å–µ –ø—Ä–∞–≤–∞!

**–•—Ä–∞–Ω–µ–Ω–∏–µ:**
- ‚úÖ GitHub Secrets (–¥–ª—è Actions)
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
- ‚úÖ –ú–µ–Ω–µ–¥–∂–µ—Ä—ã –ø–∞—Ä–æ–ª–µ–π (1Password, LastPass)
- ‚ùå –ù–ï –≤ –∫–æ–¥–µ –ø—Ä–æ–µ–∫—Ç–∞
- ‚ùå –ù–ï –≤ git
- ‚ùå –ù–ï –≤ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö

---

### 2. SSH –∫–ª—é—á–∏

**–°–æ–∑–¥–∞–Ω–∏–µ:**
```bash
ssh-keygen -t rsa -b 4096 -C "server-deploy"
# –£–∫–∞–∂–∏—Ç–µ –ø—É—Ç—å: ~/.ssh/deploy_key
# –ù–ï —É—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–π—Ç–µ –ø–∞—Ä–æ–ª—å (–¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏–∏)
```

**–ü—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞:**
```bash
chmod 600 ~/.ssh/deploy_key      # –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á
chmod 644 ~/.ssh/deploy_key.pub  # –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á
```

**–•—Ä–∞–Ω–µ–Ω–∏–µ:**
- ‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á: —Ç–æ–ª—å–∫–æ –Ω–∞ –≤–∞—à–µ–º –∫–æ–º–ø—å—é—Ç–µ—Ä–µ
- ‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á: –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ (`~/.ssh/authorized_keys`)
- ‚úÖ –î–ª—è GitHub Actions: –≤ Secrets –∫–∞–∫ `SSH_PRIVATE_KEY`
- ‚ùå –ù–ï –∫–æ–º–º–∏—Ç—å—Ç–µ –ø—Ä–∏–≤–∞—Ç–Ω—ã–µ –∫–ª—é—á–∏

---

### 3. GitHub Secrets (–¥–ª—è Actions)

**–î–æ–±–∞–≤–ª–µ–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–æ–≤:**
1. –†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π ‚Üí Settings ‚Üí Secrets and variables ‚Üí Actions
2. New repository secret
3. –î–æ–±–∞–≤—å—Ç–µ:
   - `SSH_PRIVATE_KEY` - –ø—Ä–∏–≤–∞—Ç–Ω—ã–π SSH –∫–ª—é—á
   - `SERVER_HOST` - –¥–æ–º–µ–Ω/IP —Å–µ—Ä–≤–µ—Ä–∞
   - `SERVER_USER` - –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å SSH
   - `SERVER_PORT` - –ø–æ—Ä—Ç SSH (–æ–±—ã—á–Ω–æ 22)
   - `GITHUB_TOKEN` - Personal Access Token (–µ—Å–ª–∏ –Ω—É–∂–µ–Ω)

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ workflow:**
```yaml
- name: Deploy
  env:
    SSH_KEY: ${{ secrets.SSH_PRIVATE_KEY }}
    SERVER_HOST: ${{ secrets.SERVER_HOST }}
```

---

### 4. –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

**–°–æ–∑–¥–∞–Ω–∏–µ —Ñ–∞–π–ª–∞:**
```bash
nano ~/.env.deploy
# –î–æ–±–∞–≤—å—Ç–µ:
# GITHUB_TOKEN=your_token_here
# SERVER_PATH=/path/to/project
```

**–ó–∞—â–∏—Ç–∞ —Ñ–∞–π–ª–∞:**
```bash
chmod 600 ~/.env.deploy
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ —Å–∫—Ä–∏–ø—Ç–∞—Ö:**
```bash
source ~/.env.deploy
# –¢–µ–ø–µ—Ä—å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–æ—Å—Ç—É–ø–Ω—ã
```

---

## üõ°Ô∏è –ü—Ä–æ–≤–µ—Ä–∫–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

### –ß–µ–∫–ª–∏—Å—Ç:

- [ ] –í—Å–µ —Ç–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è
- [ ] –¢–æ–∫–µ–Ω—ã –∏–º–µ—é—Ç –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–µ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞
- [ ] –ù–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∏—Å—Ç–æ—Ä–∏–∏ git (–ø—Ä–æ–≤–µ—Ä—å—Ç–µ: `git log --all --full-history --source -S "ghp_"`)
- [ ] SSH –∫–ª—é—á–∏ –∑–∞—â–∏—â–µ–Ω—ã –ø—Ä–∞–≤–∏–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏ (600)
- [ ] –°–µ–∫—Ä–µ—Ç—ã —Ö—Ä–∞–Ω—è—Ç—Å—è –≤ GitHub Secrets
- [ ] `.env` —Ñ–∞–π–ª—ã –≤ `.gitignore`
- [ ] –ù–µ—Ç —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Å–∫—Ä–∏–Ω—à–æ—Ç–∞—Ö/—á–∞—Ç–∞—Ö

---

## üö® –ï—Å–ª–∏ —Ç–æ–∫–µ–Ω —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω

### –ù–µ–º–µ–¥–ª–µ–Ω–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è:

1. **–£–¥–∞–ª–∏—Ç–µ —Ç–æ–∫–µ–Ω –≤ GitHub:**
   - Settings ‚Üí Developer settings ‚Üí Personal access tokens
   - –ù–∞–π–¥–∏—Ç–µ —Ç–æ–∫–µ–Ω ‚Üí Delete

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å:**
   - Settings ‚Üí Security log
   - –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å

3. **–°–æ–∑–¥–∞–π—Ç–µ –Ω–æ–≤—ã–π —Ç–æ–∫–µ–Ω:**
   - –° –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∞–≤–∞–º–∏
   - –° –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–Ω—ã–º —Å—Ä–æ–∫–æ–º –¥–µ–π—Å—Ç–≤–∏—è

4. **–û–±–Ω–æ–≤–∏—Ç–µ –≤—Å–µ –º–µ—Å—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è:**
   - GitHub Secrets
   - –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
   - –°–∫—Ä–∏–ø—Ç—ã –¥–µ–ø–ª–æ—è

5. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ git –∏—Å—Ç–æ—Ä–∏—é:**
```bash
# –ü–æ–∏—Å–∫ —Ç–æ–∫–µ–Ω–æ–≤ –≤ –∏—Å—Ç–æ—Ä–∏–∏
git log --all --full-history --source -S "ghp_" 
git log --all --full-history --source -S "gho_"
git log --all --full-history --source -S "github_pat_"
```

6. **–ï—Å–ª–∏ —Ç–æ–∫–µ–Ω –±—ã–ª –≤ git:**
```bash
# –£–¥–∞–ª–∏—Ç–µ –∏–∑ –∏—Å—Ç–æ—Ä–∏–∏ (–û–°–¢–û–†–û–ñ–ù–û!)
git filter-branch --force --index-filter \
  "git rm --cached --ignore-unmatch path/to/file" \
  --prune-empty --tag-name-filter cat -- --all

# –ò–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–π—Ç–µ BFG Repo-Cleaner
```

---

## üìã –†–µ–∫–æ–º–µ–Ω–¥—É–µ–º–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞

```
project/
‚îú‚îÄ‚îÄ .github/
‚îÇ   ‚îî‚îÄ‚îÄ workflows/
‚îÇ       ‚îî‚îÄ‚îÄ deploy.yml          # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Secrets
‚îú‚îÄ‚îÄ scripts/
‚îÇ   ‚îú‚îÄ‚îÄ deploy.sh               # –ß–∏—Ç–∞–µ—Ç –∏–∑ .env
‚îÇ   ‚îî‚îÄ‚îÄ webhook-deploy.php       # –ò—Å–ø–æ–ª—å–∑—É–µ—Ç $SECRET
‚îú‚îÄ‚îÄ .env.example                 # –®–∞–±–ª–æ–Ω (–ë–ï–ó —Ä–µ–∞–ª—å–Ω—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π)
‚îú‚îÄ‚îÄ .env                         # –í .gitignore!
‚îî‚îÄ‚îÄ .gitignore                   # –í–∫–ª—é—á–∞–µ—Ç .env, *.key, *.pem
```

---

## üîê Best Practices

1. **–ü—Ä–∏–Ω—Ü–∏–ø –º–∏–Ω–∏–º–∞–ª—å–Ω—ã—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π:**
   - –î–∞–≤–∞–π—Ç–µ —Ç–æ–ª—å–∫–æ –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞
   - –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π—Ç–µ —Å—Ä–æ–∫ –¥–µ–π—Å—Ç–≤–∏—è

2. **–†–æ—Ç–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–æ–≤:**
   - –ú–µ–Ω—è–π—Ç–µ —Ç–æ–∫–µ–Ω—ã –∫–∞–∂–¥—ã–µ 90 –¥–Ω–µ–π
   - –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ —Ä–∞–∑–Ω—ã–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ü–µ–ª–µ–π

3. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –†–µ–≥—É–ª—è—Ä–Ω–æ –ø—Ä–æ–≤–µ—Ä—è–π—Ç–µ Security log –≤ GitHub
   - –ù–∞—Å—Ç—Ä–æ–π—Ç–µ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏

4. **–î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è:**
   - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ, –∫–∞–∫–∏–µ —Ç–æ–∫–µ–Ω—ã –¥–ª—è —á–µ–≥–æ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è
   - –•—Ä–∞–Ω–∏—Ç–µ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—é –æ—Ç–¥–µ–ª—å–Ω–æ –æ—Ç —Ç–æ–∫–µ–Ω–æ–≤

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [GitHub: Creating a personal access token](https://docs.github.com/en/authentication/keeping-your-account-and-data-secure/creating-a-personal-access-token)
- [GitHub: Security best practices](https://docs.github.com/en/code-security/security-guides/security-overview)
- [OWASP: Secrets Management](https://owasp.org/www-community/vulnerabilities/Use_of_hard-coded_cryptographic_key)

---

## ‚ö° –ë—ã—Å—Ç—Ä–∞—è –∫–æ–º–∞–Ω–¥–∞ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏

```bash
# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è —Ç–æ–∫–µ–Ω–æ–≤ –≤ git –∏—Å—Ç–æ—Ä–∏–∏
git log --all --full-history --source -S "ghp_" | head -20
git log --all --full-history --source -S "gho_" | head -20

# –ü—Ä–æ–≤–µ—Ä–∫–∞ .gitignore
cat .gitignore | grep -E "(\.env|\.key|\.pem|token|secret)"

# –ü–æ–∏—Å–∫ —Ç–æ–∫–µ–Ω–æ–≤ –≤ —Ç–µ–∫—É—â–∏—Ö —Ñ–∞–π–ª–∞—Ö (–∫—Ä–æ–º–µ node_modules)
grep -r "ghp_" . --exclude-dir=node_modules --exclude-dir=.git
```

