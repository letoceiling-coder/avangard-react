# –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ

## –û–ø–∏—Å–∞–Ω–∏–µ

–•—É–∫ `useFavorites` —Ç–µ–ø–µ—Ä—å –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—é –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤ —Å Supabase –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è.

## –§—É–Ω–∫—Ü–∏–æ–Ω–∞–ª—å–Ω–æ—Å—Ç—å

‚úÖ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ localStorage** - –∏–∑–±—Ä–∞–Ω–Ω–æ–µ —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –¥–ª—è –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π  
‚úÖ **–°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å Supabase** - –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º  
‚úÖ **–ú–µ—Ç–æ–¥ toggleFavorite** - —É–¥–æ–±–Ω—ã–π –º–µ—Ç–æ–¥ –¥–ª—è –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ  
‚úÖ **–ò–∫–æ–Ω–∫–∞ ‚ù§Ô∏è –≤ –∫–∞—Ä—Ç–æ—á–∫–∞—Ö** - —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –≤ PropertyCard

## –ù–∞—Å—Ç—Ä–æ–π–∫–∞ —Ç–∞–±–ª–∏—Ü—ã –≤ Supabase

–î–ª—è —Ä–∞–±–æ—Ç—ã —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏ –Ω—É–∂–Ω–æ —Å–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `user_favorites` –≤ Supabase:

```sql
-- –°–æ–∑–¥–∞–Ω–∏–µ —Ç–∞–±–ª–∏—Ü—ã –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
CREATE TABLE IF NOT EXISTS user_favorites (
  user_id UUID PRIMARY KEY REFERENCES auth.users(id) ON DELETE CASCADE,
  favorites JSONB NOT NULL DEFAULT '[]'::jsonb,
  updated_at TIMESTAMP WITH TIME ZONE DEFAULT NOW(),
  created_at TIMESTAMP WITH TIME ZONE DEFAULT NOW()
);

-- –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–∞ –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –ø–æ–∏—Å–∫–∞
CREATE INDEX IF NOT EXISTS idx_user_favorites_user_id ON user_favorites(user_id);

-- –í–∫–ª—é—á–µ–Ω–∏–µ RLS (Row Level Security)
ALTER TABLE user_favorites ENABLE ROW LEVEL SECURITY;

-- –ü–æ–ª–∏—Ç–∏–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç —á–∏—Ç–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ
CREATE POLICY "Users can read own favorites"
  ON user_favorites
  FOR SELECT
  USING (auth.uid() = user_id);

-- –ü–æ–ª–∏—Ç–∏–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –æ–±–Ω–æ–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ
CREATE POLICY "Users can update own favorites"
  ON user_favorites
  FOR UPDATE
  USING (auth.uid() = user_id);

-- –ü–æ–ª–∏—Ç–∏–∫–∞: –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –º–æ–≥—É—Ç –≤—Å—Ç–∞–≤–ª—è—Ç—å —Ç–æ–ª—å–∫–æ —Å–≤–æ–∏ –∏–∑–±—Ä–∞–Ω–Ω—ã–µ
CREATE POLICY "Users can insert own favorites"
  ON user_favorites
  FOR INSERT
  WITH CHECK (auth.uid() = user_id);
```

## –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

### –í –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞—Ö:

```tsx
import { useFavorites } from '@/hooks/useFavorites';

const MyComponent = () => {
  const { isFavorite, toggleFavorite, favorites } = useFavorites();
  
  const handleToggle = async (propertyId: string, property: Property) => {
    await toggleFavorite(propertyId, property);
  };
  
  return (
    <button onClick={() => handleToggle(property.id, property)}>
      {isFavorite(property.id) ? '‚ù§Ô∏è' : 'ü§ç'}
    </button>
  );
};
```

### –í PropertyCard:

–ò–∫–æ–Ω–∫–∞ ‚ù§Ô∏è —É–∂–µ –¥–æ–±–∞–≤–ª–µ–Ω–∞ –∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç `toggleFavorite` –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏.

## –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è

1. **–ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Å—Ç—Ä–∞–Ω–∏—Ü—ã:**
   - –ò–∑–±—Ä–∞–Ω–Ω–æ–µ –∑–∞–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ localStorage
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω, –∏–∑–±—Ä–∞–Ω–Ω–æ–µ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–æ–º

2. **–ü—Ä–∏ –ª–æ–≥–∏–Ω–µ:**
   - –õ–æ–∫–∞–ª—å–Ω–æ–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ –æ–±—ä–µ–¥–∏–Ω—è–µ—Ç—Å—è —Å —Å–µ—Ä–≤–µ—Ä–Ω—ã–º
   - –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç —É —Å–µ—Ä–≤–µ—Ä–Ω—ã—Ö –¥–∞–Ω–Ω—ã—Ö
   - –†–µ–∑—É–ª—å—Ç–∞—Ç —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –∏ –≤ localStorage, –∏ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

3. **–ü—Ä–∏ –¥–æ–±–∞–≤–ª–µ–Ω–∏–∏/—É–¥–∞–ª–µ–Ω–∏–∏:**
   - –ò–∑–º–µ–Ω–µ–Ω–∏—è —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –≤ localStorage
   - –ï—Å–ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –∑–∞–ª–æ–≥–∏–Ω–µ–Ω, –∏–∑–º–µ–Ω–µ–Ω–∏—è —Ç–∞–∫–∂–µ —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ

4. **–ü—Ä–∏ –≤—ã—Ö–æ–¥–µ:**
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ

## API —Ö—É–∫–∞

```typescript
const {
  favorites: Property[],           // –ú–∞—Å—Å–∏–≤ –∏–∑–±—Ä–∞–Ω–Ω—ã—Ö –æ–±—ä–µ–∫—Ç–æ–≤
  addToFavorites: (property) => void,  // –î–æ–±–∞–≤–∏—Ç—å –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
  removeFromFavorites: (id) => void,   // –£–¥–∞–ª–∏—Ç—å –∏–∑ –∏–∑–±—Ä–∞–Ω–Ω–æ–≥–æ
  toggleFavorite: (id, property?) => Promise<void>,  // –ü–µ—Ä–µ–∫–ª—é—á–∏—Ç—å –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
  isFavorite: (id) => boolean,     // –ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –≤ –∏–∑–±—Ä–∞–Ω–Ω–æ–º –ª–∏
  clearFavorites: () => void,      // –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –∏–∑–±—Ä–∞–Ω–Ω–æ–µ
} = useFavorites();
```

## –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

- –ï—Å–ª–∏ Supabase –Ω–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω, –∏–∑–±—Ä–∞–Ω–Ω–æ–µ —Ä–∞–±–æ—Ç–∞–µ—Ç —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ
- –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –ª–æ–≥–∏–Ω–µ
- –î–∞–Ω–Ω—ã–µ –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ –∏–º–µ—é—Ç –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç –Ω–∞–¥ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –ø—Ä–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏

